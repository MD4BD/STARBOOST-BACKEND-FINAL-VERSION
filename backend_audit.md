# backend_audit.md

## 1. Entities & Column Mappings

### com.starboost.starboost_backend_demo.entity.Agency
| Field   | Column Name | Column Type | PK  | Constraints                  | Relation                                    |
|---------|-------------|-------------|-----|------------------------------|---------------------------------------------|
| id      | id          | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY |                                             |
| code    | code        | VARCHAR     |     | NOT NULL, UNIQUE             |                                             |
| name    | name        | VARCHAR     |     | NOT NULL                     |                                             |
| region  | region_id   | BIGINT      |     | NOT NULL, FK → regions(id)   | @ManyToOne(fetch=LAZY)                      |

### com.starboost.starboost_backend_demo.entity.Region
| Field     | Column Name | Column Type | PK  | Constraints                 | Relation                                           |
|-----------|-------------|-------------|-----|-----------------------------|----------------------------------------------------|
| id        | id          | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY |                                                    |
| code      | code        | VARCHAR     |     | NOT NULL, UNIQUE            |                                                    |
| name      | name        | VARCHAR     |     | NOT NULL                    |                                                    |
| agencies  | —           | —           |     | —                           | @OneToMany(mappedBy="region", cascade=ALL, orphanRemoval) |

### com.starboost.starboost_backend_demo.entity.User
| Field               | Column Name         | Column Type | PK  | Constraints                      | Relation                                                 |
|---------------------|---------------------|-------------|-----|----------------------------------|----------------------------------------------------------|
| id                  | id                  | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY |                                                          |
| firstName           | first_name          | VARCHAR     |     | NOT NULL                         |                                                          |
| lastName            | last_name           | VARCHAR     |     | NOT NULL                         |                                                          |
| email               | email               | VARCHAR     |     | NOT NULL, UNIQUE                 |                                                          |
| phoneNumber         | phone_number        | VARCHAR     |     | NOT NULL                         |                                                          |
| gender              | gender              | VARCHAR     |     | NOT NULL (enum)                  |                                                          |
| dateOfBirth         | date_of_birth       | DATE        |     | NOT NULL                         |                                                          |
| role                | role                | VARCHAR     |     | NOT NULL (enum)                  |                                                          |
| registrationNumber  | registration_number | VARCHAR     |     | UNIQUE                           |                                                          |
| password            | password            | VARCHAR     |     | NOT NULL                         |                                                          |
| agency              | agency_id           | BIGINT      |     |                                  | @ManyToOne(fetch=LAZY) → agencies(id)                   |
| region              | region_id           | BIGINT      |     |                                  | @ManyToOne(fetch=LAZY) → regions(id)                    |

### com.starboost.starboost_backend_demo.entity.Challenge
| Field            | Column Name               | Column Type | PK  | Constraints                           | Relation                                                                           |
|------------------|---------------------------|-------------|-----|---------------------------------------|------------------------------------------------------------------------------------|
| id               | id                        | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY      |                                                                                    |
| name             | name                      | VARCHAR     |     | NOT NULL                              |                                                                                    |
| startDate        | start_date                | DATE        |     | NOT NULL                              |                                                                                    |
| endDate          | end_date                  | DATE        |     | NOT NULL                              |                                                                                    |
| status           | status                    | VARCHAR     |     | NOT NULL, default 'ONGOING'           |                                                                                    |
| deleted          | deleted                   | BOOLEAN     |     | NOT NULL, default false               |                                                                                    |
| targetRoles      | —                         | —           |     | —                                     | @ElementCollection → challenge_target_roles                                       |
| targetProducts   | —                         | —           |     | —                                     | @ElementCollection → challenge_products                                            |
| rules            | —                         | —           |     | —                                     | @OneToMany → challenge_rules (cascade=ALL, orphanRemoval)                           |
| winningRules     | —                         | —           |     | —                                     | @OneToMany → challenge_winning_rules (cascade=ALL, orphanRemoval)                   |
| rewardRules      | —                         | —           |     | —                                     | @OneToMany → challenge_reward_rules (cascade=ALL, orphanRemoval)                    |

### com.starboost.starboost_backend_demo.entity.ChallengeParticipant
| Field     | Column Name   | Column Type | PK  | Constraints                      | Relation                                        |
|-----------|---------------|-------------|-----|----------------------------------|-------------------------------------------------|
| id        | id            | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY |                                                 |
| challenge | challenge_id  | BIGINT      |     | NOT NULL, FK → challenges(id)    | @ManyToOne(fetch=LAZY)                          |
| user      | user_id       | BIGINT      |     | NOT NULL, FK → users(id)         | @ManyToOne(fetch=LAZY)                          |
| role      | role          | VARCHAR     |     | NOT NULL (enum)                  |                                                 |
| agencyId  | agency_id     | BIGINT      |     |                                  | (no JPA relation)                               |
| regionId  | region_id     | BIGINT      |     |                                  | (no JPA relation)                               |
| status    | status        | VARCHAR     |     | NOT NULL, default 'ACTIVE'       |                                                 |

### com.starboost.starboost_backend_demo.entity.ChallengeRewardRule
| Field        | Column Name    | Column Type | PK  | Constraints                       | Relation                                              |
|--------------|----------------|-------------|-----|-----------------------------------|-------------------------------------------------------|
| id           | id             | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY  |                                                       |
| challenge    | challenge_id   | BIGINT      |     | NOT NULL, FK → challenges(id)     | @ManyToOne(fetch=LAZY)                                |
| roleCategory | role_category  | VARCHAR     |     | NOT NULL (enum)                   |                                                       |
| payoutType   | payout_type    | VARCHAR     |     | NOT NULL (enum)                   |                                                       |
| tierMin      | tier_min       | DOUBLE      |     | NOT NULL                          |                                                       |
| tierMax      | tier_max       | DOUBLE      |     | NOT NULL                          |                                                       |
| baseAmount   | base_amount    | DOUBLE      |     | NOT NULL                          |                                                       |
| gift         | gift           | VARCHAR     |     |                                   |                                                       |

### com.starboost.starboost_backend_demo.entity.ChallengeWinningRule
| Field           | Column Name       | Column Type | PK  | Constraints                        | Relation                                                |
|-----------------|-------------------|-------------|-----|------------------------------------|---------------------------------------------------------|
| id              | id                | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY   |                                                         |
| challenge       | challenge_id      | BIGINT      |     | NOT NULL, FK → challenges(id)      | @ManyToOne(fetch=LAZY)                                  |
| roleCategory    | role_category     | VARCHAR     |     | NOT NULL (enum)                    |                                                         |
| thresholdMin    | threshold_min     | DOUBLE      |     | NOT NULL                           |                                                         |
| conditionType   | condition_type    | VARCHAR     |     | NOT NULL (enum)                    |                                                         |
| formulaDetails  | formula_details   | OID (LOB)   |     |                                    |                                                         |

### com.starboost.starboost_backend_demo.entity.Rule
| Field              | Column Name        | Column Type | PK  | Constraints                         | Relation                                |
|--------------------|--------------------|-------------|-----|-------------------------------------|-----------------------------------------|
| id                 | id                 | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY    |                                         |
| contractType       | contract_type      | VARCHAR     |     | (enum)                              |                                         |
| transactionNature  | transaction_nature | VARCHAR     |     | (enum)                              |                                         |
| packType           | pack_type          | VARCHAR     |     | (enum)                              |                                         |
| challenge          | challenge_id       | BIGINT      |     | NOT NULL, FK → challenges(id)       | @ManyToOne(fetch=LAZY)                  |

### com.starboost.starboost_backend_demo.entity.ScoreRule
| Field         | Column Name    | Column Type | PK  | Constraints                         | Relation                                |
|---------------|----------------|-------------|-----|-------------------------------------|-----------------------------------------|
| id            | id             | BIGINT      | ✓   | GENERATED BY DEFAULT AS IDENTITY    |                                         |
| scoreType     | score_type     | VARCHAR     |     | (enum)                              |                                         |
| contractType  | contract_type  | VARCHAR     |     | (enum)                              |                                         |
| packType      | pack_type      | VARCHAR     |     | (enum)                              |                                         |
| points        | points         | INTEGER     |     |                                     |                                         |
| revenueUnit   | revenue_unit   | INTEGER     |     |                                     |                                         |
| challenge     | challenge_id   | BIGINT      |     | NOT NULL, FK → challenges(id)       | @ManyToOne(fetch=LAZY)                  |

### com.starboost.starboost_backend_demo.entity.SalesTransaction
| Field              | Column Name       | Column Type   | PK  | Constraints                          | Relation                                |
|--------------------|-------------------|---------------|-----|--------------------------------------|-----------------------------------------|
| id                 | id                | BIGINT        | ✓   | GENERATED BY DEFAULT AS IDENTITY     |                                         |
| premium            | premium           | DOUBLE        |     |                                      |                                         |
| product            | product           | VARCHAR       |     | (enum)                               |                                         |
| contractType       | contract_type     | VARCHAR       |     | (enum)                               |                                         |
| transactionNature  | transaction_nature| VARCHAR       |     | (enum)                               |                                         |
| sellerId           | seller_id         | BIGINT        |     |                                      |                                         |
| sellerRole         | seller_role       | VARCHAR       |     | (enum)                               |                                         |
| agencyId           | agency_id         | BIGINT        |     |                                      |                                         |
| regionId           | region_id         | BIGINT        |     |                                      |                                         |
| saleDate           | sale_date         | TIMESTAMP     |     |                                      |                                         |
| sellerName         | seller_name       | VARCHAR       |     |                                      |                                         |
| challenge          | challenge_id      | BIGINT        |     | NOT NULL, FK → challenges(id)        | @ManyToOne(fetch=LAZY)                  |


## 2. Flyway Migrations & Columns

| Script Filename                            | Table(s) Affected                                                                                                                  | Columns Created/Altered                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|--------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **V1__Initial_schema.sql**                 | `agencies`, `challenge_participants`, `challenge_products`, `challenge_reward_rules`, `challenge_rules`, `challenge_target_roles`,<br>`challenge_winning_rules`, `challenges`, `regions`, `sales_transaction`, `score_rules`, `users` | **Created all tables** with the following columns: <br>– **agencies**: `id`, `code`, `name`, `region_id`<br>– **challenge_participants**: `id`, `agency_id`, `region_id`, `role`, `total_contracts`, `total_revenue`, `total_score`, `challenge_id`, `user_id`, `status`<br>– **challenge_products**: `challenge_id`, `target_products`<br>– **challenge_reward_rules**: `id`, `base_amount`, `challenge_id`, `payout_type`, `role_category`, `tier_max`, `tier_min`<br>– **challenge_rules**: `id`, `contract_type`, `pack_type`, `transaction_nature`, `challenge_id`<br>– **challenge_target_roles**: `challenge_id`, `target_roles`<br>– **challenge_winning_rules**: `id`, `challenge_id`, `condition_type`, `role_category`, `threshold_min`, `formula_details`<br>– **challenges**: `id`, various reward & condition columns, `name`, `start_date`, `end_date`, `status`, `deleted`, etc.<br>– **regions**: `id`, `code`, `name`<br>– **sales_transaction**: `id`, `agency_id`, `contract_type`, `premium`, `product`, `region_id`, `sale_date`, `seller_id`, `seller_name`, `seller_role`, `transaction_nature`, `challenge_id`<br>– **score_rules**: `id`, `contract_type`, `pack_type`, `points`, `revenue_unit`, `score_type`, `challenge_id`<br>– **users**: `id`, `date_of_birth`, `email`, `first_name`, `gender`, `last_name`, `password`, `phone_number`, `registration_number`, `role`, `agency_id`, `region_id` |
| **V2__add_gift_to_challenge_reward_rule.sql** | `challenge_reward_rules`                                                                                                           | Added column `gift VARCHAR(255)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **V3__drop_base_amount_not_null.sql**        | `challenge_reward_rules`                                                                                                           | Dropped NOT NULL constraint on column `base_amount`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **V4__fix_base_amount.sql**                  | `challenge_reward_rules`                                                                                                           | 1. Updated all NULL `base_amount` to `0.0`<br>2. Set column default to `0.0`<br>3. Altered column `base_amount` to NOT NULL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |


## 3. Repositories & Key Methods

| Repository Interface                       | Inherited JpaRepository Methods                              | Custom Query Methods                                                                                                                                                                                         |
|--------------------------------------------|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **AgencyRepository**<br>`JpaRepository<Agency, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `long countByRegionId(Long regionId)`                                                                                                                            |
| **ChallengeParticipantRepository**<br>`JpaRepository<ChallengeParticipant, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `List<ChallengeParticipant> findAllByChallenge_Id(Long challengeId)`<br>`List<ChallengeParticipant> findAllByChallenge_IdAndRole(Long challengeId, Role role)`<br>`Optional<ChallengeParticipant> findByUserId(Long userId)`<br>`long countByChallenge_IdAndAgencyIdAndRole(Long challengeId, Long agencyId, Role role)`<br>`long countByChallenge_IdAndRegionIdAndRole(Long challengeId, Long regionId, Role role)`<br>`long countByChallenge_IdAndAgencyId(Long challengeId, Long agencyId)`<br>`long countByChallenge_IdAndRegionId(Long challengeId, Long regionId)`<br>`void deleteAllByChallenge_Id(Long challengeId)`<br>`Optional<ChallengeParticipant> findByChallenge_IdAndUserId(Long challengeId, Long userId)` |
| **ChallengeRepository**<br>`JpaRepository<Challenge, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | *(none)*                                                                                                                                                                                                            |
| **ChallengeRewardRuleRepository**<br>`JpaRepository<ChallengeRewardRule, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `List<ChallengeRewardRule> findAllByChallenge_Id(Long challengeId)`<br>`List<ChallengeRewardRule> findAllByChallenge_IdAndRoleCategory(Long challengeId, Role roleCategory)`                                  |
| **ChallengeWinningRuleRepository**<br>`JpaRepository<ChallengeWinningRule, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `List<ChallengeWinningRule> findAllByChallenge_Id(Long challengeId)`<br>`List<ChallengeWinningRule> findAllByChallenge_IdAndRoleCategory(Long challengeId, Role roleCategory)`                            |
| **RegionRepository**<br>`JpaRepository<Region, Long>`      | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | *(none)*                                                                                                                                                                                                            |
| **RuleRepository**<br>`JpaRepository<Rule, Long>`          | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | *(none – placeholder for future findAllByChallengeId(...))*                                                                                                                |
| **SalesTransactionRepository**<br>`JpaRepository<SalesTransaction, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `List<SalesTransaction> findAllByChallenge_Id(Long challengeId)`<br>`long countByChallenge_IdAndSellerId(Long challengeId, Long sellerId)`<br>`double sumPremiumByChallengeIdAndSellerId(Long challengeId, Long sellerId)` |
| **ScoreRuleRepository**<br>`JpaRepository<ScoreRule, Long>` | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `List<ScoreRule> findAllByChallenge_Id(Long challengeId)`                                                                                                            |
| **UserRepository**<br>`JpaRepository<User, Long>`           | save, saveAll, findById, findAll, findAllById, count, existsById, deleteById, delete, deleteAll | `Optional<User> findByEmail(String email)`                                                                                                                           |


## 4. Services & Public API

| Service Interface                     | Method Signatures                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **AgencyService**                     | `List<AgencyDto> findAll()`<br>`AgencyDto findById(Long id)`<br>`AgencyDto create(AgencyDto agencyDto)`<br>`AgencyDto update(Long id, AgencyDto agencyDto)`<br>`void delete(Long id)`                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **ChallengeEvaluationService**        | `List<WinnerDto> listWinners(Long challengeId)`<br>`List<WinnerDto> listWinnersByRole(Long challengeId, Role roleCategory)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **ChallengeLeaderboardService**       | `List<ChallengeLeaderboardDto> agents(Long challengeId)`<br>`List<ChallengeLeaderboardDto> commercials(Long challengeId)`<br>`List<ChallengeLeaderboardDto> agencies(Long challengeId)`<br>`List<ChallengeLeaderboardDto> regions(Long challengeId)`                                                                                                                                                                                                                                                                                                                                                                               |
| **ChallengeParticipantService**       | `List<ChallengeParticipantDto> enrollParticipants(Long challengeId, Set<String> targetRoles)`<br>`List<ChallengeParticipantDto> findByChallengeId(Long challengeId)`<br>`ChallengeParticipantDto findByChallengeAndUser(Long challengeId, Long userId)`<br>`ChallengeParticipantDto findByParticipantId(Long participantId)`<br>`List<ChallengeParticipantDto> findByChallengeAndRole(Long challengeId, Role role, Long filterId, String filterName)`<br>`List<Long> listParticipantIds(Long challengeId, Role roleCategory)`<br>`Long getAgencyIdForUser(Long userId)`<br>`Long getRegionIdForUser(Long userId)`<br>`long countCommercialsInAgency(Long challengeId, Long agencyId)`<br>`long countSalesPointsInRegion(Long challengeId, Long regionId)` |
| **ChallengePerformanceService**       | `List<PerformanceDto> agents(Long challengeId, Long filterUserId, String filterName)`<br>`List<PerformanceDto> commercials(Long challengeId, Long filterUserId, String filterName)`<br>`List<PerformanceDto> agencies(Long challengeId, Long filterAgencyId, String filterName)`<br>`List<PerformanceDto> regions(Long challengeId, Long filterRegionId, String filterName)`<br>`long getContractCount(Long challengeId, Long userId)`<br>`double getRevenue(Long challengeId, Long userId)`<br>`int getScore(Long challengeId, Long userId)`<br>`double getAgencyTotalRevenue(Long challengeId, Long agencyId)`<br>`int getAgencyTotalScore(Long challengeId, Long agencyId)`<br>`long getAgencyTotalContracts(Long challengeId, Long agencyId)`<br>`double getRegionTotalRevenue(Long challengeId, Long regionId)`<br>`int getRegionTotalScore(Long challengeId, Long regionId)`<br>`long getRegionTotalContracts(Long challengeId, Long regionId)` |
| **ChallengeRewardService**            | `List<RewardRuleDto> listRewardRules(Long challengeId, Role roleCategory)`<br>`double computeReward(Long challengeId, Role roleCategory, Long unitCount, double metricValue)`<br>`List<RewardRuleDto> listAllRewardRules(Long challengeId)`                                                                                                                                                                                                                                                                                                                                                                                   |
| **ChallengeService**                  | `List<ChallengeDto> findAll()`<br>`ChallengeDto findById(Long id)`<br>`ChallengeDto create(ChallengeDto dto)`<br>`ChallengeDto update(Long id, ChallengeDto dto)`<br>`void delete(Long id)`                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **ChallengeWinningService**           | `List<WinningRuleDto> listWinningRules(Long challengeId)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **RegionService**                     | `List<RegionDto> findAll()`<br>`RegionDto findById(Long id)`<br>`RegionDto create(RegionDto regionDto)`<br>`RegionDto update(Long id, RegionDto regionDto)`<br>`void delete(Long id)`                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **SalesTransactionService**           | `SalesTransactionDto create(SalesTransactionDto dto)`<br>`SalesTransactionDto createForChallenge(Long challengeId, SalesTransactionDto dto)`<br>`List<SalesTransactionDto> findAll()`<br>`SalesTransactionDto findById(Long id)`<br>`List<SalesTransactionDto> findAllByChallengeId(Long challengeId)`<br>`SalesTransactionDto update(Long id, SalesTransactionDto dto)`<br>`void deleteById(Long id)`<br>`void deleteAll()`<br>`List<SalesTransactionDto> findByChallengeAndRole(Long challengeId, Role role)`<br>`List<SalesTransactionDto> findByChallengeAndSellerId(Long challengeId, Long sellerId)`<br>`List<SalesTransactionDto> findByChallengeAndSellerName(Long challengeId, String sellerName)` |
| **ScoreRuleService**                  | `List<ScoreRuleDto> findAllByChallengeId(Long challengeId)`<br>`ScoreRuleDto findById(Long challengeId, Long ruleId)`<br>`ScoreRuleDto createForChallenge(Long challengeId, ScoreRuleDto dto)`<br>`ScoreRuleDto updateForChallenge(Long challengeId, Long ruleId, ScoreRuleDto dto)`<br>`void deleteForChallenge(Long challengeId, Long ruleId)`                                                                                                                                                                                                                                                             |
| **ScoringService**                    | `Map<Long, Integer> calculateScores(Long challengeId)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **UserService**                       | `List<UserDto> findAll()`<br>`UserDto findById(Long id)`<br>`UserDto create(UserDto userDto)`<br>`UserDto update(Long id, UserDto userDto)`<br>`void delete(Long id)`                                                                                                                                                                                                                                                                                                                                                                                                                                                               |

## 5. Controllers & HTTP Endpoints

| HTTP Verb | Path                                                            | Request DTO                       | Response DTO                              |
|-----------|-----------------------------------------------------------------|-----------------------------------|-------------------------------------------|
| **Agencies**                                                                                                                                                                 |
| GET       | `/api/agencies`                                                 | —                                 | `List<AgencyDto>`                         |
| GET       | `/api/agencies/{id}`                                            | —                                 | `AgencyDto`                               |
| POST      | `/api/agencies`                                                 | `AgencyDto`                       | `AgencyDto`                               |
| PUT       | `/api/agencies/{id}`                                            | `AgencyDto`                       | `AgencyDto`                               |
| DELETE    | `/api/agencies/{id}`                                            | —                                 | —                                         |
| **Auth**                                                                                                                                                                      |
| POST      | `/api/auth/login`                                               | `LoginRequest`                    | `LoginResponse`                           |
| **Challenges**                                                                                                                                                                |
| GET       | `/api/challenges`                                               | —                                 | `List<ChallengeDto>`                      |
| POST      | `/api/challenges`                                               | `ChallengeDto`                    | `ChallengeDto`                            |
| GET       | `/api/challenges/{id}`                                          | —                                 | `ChallengeDto`                            |
| PUT       | `/api/challenges/{id}`                                          | `ChallengeDto`                    | `ChallengeDto`                            |
| DELETE    | `/api/challenges/{id}`                                          | —                                 | —                                         |
| GET       | `/api/challenges/{id}/rules`                                   | —                                 | `Map<String, List<RuleDto>>`              |
| **Winners**                                                                                                                                                                   |
| GET       | `/api/challenges/{challengeId}/winners`                        | —                                 | `List<WinnerDto>`                         |
| GET       | `/api/challenges/{challengeId}/winners/{role}`                 | —                                 | `List<WinnerDto>`                         |
| **Leaderboard**                                                                                                                                                               |
| GET       | `/api/challenges/{challengeId}/leaderboard/agents`             | (optional) `filterId`, `filterName` | `List<ChallengeLeaderboardDto>`           |
| GET       | `/api/challenges/{challengeId}/leaderboard/commercials`        | (optional) `filterId`, `filterName` | `List<ChallengeLeaderboardDto>`           |
| GET       | `/api/challenges/{challengeId}/leaderboard/agencies`           | (optional) `filterId`, `filterName` | `List<ChallengeLeaderboardDto>`           |
| GET       | `/api/challenges/{challengeId}/leaderboard/regions`            | (optional) `filterId`, `filterName` | `List<ChallengeLeaderboardDto>`           |
| **Participants**                                                                                                                                                              |
| GET       | `/api/challenges/{challengeId}/participants`                   | (optional) `filterId`, `filterName` | `List<ChallengeParticipantDto>`           |
| GET       | `/api/challenges/{challengeId}/participants/agents`            | (optional) `filterId`, `filterName` | `List<ChallengeParticipantDto>`           |
| GET       | `/api/challenges/{challengeId}/participants/commercials`       | (optional) `filterId`, `filterName` | `List<ChallengeParticipantDto>`           |
| GET       | `/api/challenges/{challengeId}/participants/agency-managers`   | (optional) `filterId`, `filterName` | `List<ChallengeParticipantDto>`           |
| GET       | `/api/challenges/{challengeId}/participants/regional-managers` | (optional) `filterId`, `filterName` | `List<ChallengeParticipantDto>`           |
| GET       | `/api/challenges/{challengeId}/participants/animators`         | (optional) `filterId`, `filterName` | `List<ChallengeParticipantDto>`           |
| **Rewards**                                                                                                                                                                   |
| GET       | `/api/challenges/{challengeId}/rewards`                        | —                                 | `List<RewardRuleDto>`                     |
| GET       | `/api/challenges/{challengeId}/rewards/{role}`                 | —                                 | `List<RewardRuleDto>`                     |
| GET       | `/api/challenges/{challengeId}/rewards/{role}/compute`         | `unitCount`, `metricValue` as query params | `double`                            |
| **Winning Rules**                                                                                                                                                             |
| GET       | `/api/challenges/{challengeId}/winning-rules`                  | —                                 | `List<WinningRuleDto>`                    |
| GET       | `/api/challenges/{challengeId}/winning-rules/{roleCategory}`   | —                                 | `List<WinningRuleDto>`                    |
| **Performance**                                                                                                                                                               |
| GET       | `/api/challenges/{challengeId}/performance/agents`             | (optional) `filterId`, `filterName` | `List<PerformanceDto>`                    |
| GET       | `/api/challenges/{challengeId}/performance/commercials`        | (optional) `filterId`, `filterName` | `List<PerformanceDto>`                    |
| GET       | `/api/challenges/{challengeId}/performance/agencies`           | (optional) `filterId`, `filterName` | `List<PerformanceDto>`                    |
| GET       | `/api/challenges/{challengeId}/performance/regions`            | (optional) `filterId`, `filterName` | `List<PerformanceDto>`                    |
| **Regions**                                                                                                                                                                   |
| GET       | `/api/regions`                                                 | —                                 | `List<RegionDto>`                         |
| POST      | `/api/regions`                                                 | `RegionDto`                       | `RegionDto`                               |
| GET       | `/api/regions/{id}`                                            | —                                 | `RegionDto`                               |
| PUT       | `/api/regions/{id}`                                            | `RegionDto`                       | `RegionDto`                               |
| DELETE    | `/api/regions/{id}`                                            | —                                 | —                                         |
| **Sales Transactions**                                                                                                                                                        |
| POST      | `/api/challenges/{challengeId}/sales`                          | `SalesTransactionDto`             | `SalesTransactionDto`                     |
| GET       | `/api/challenges/{challengeId}/sales`                          | —                                 | `List<SalesTransactionDto>`               |
| GET       | `/api/challenges/{challengeId}/sales/agents`                   | (optional) `id`, `name`           | `List<SalesTransactionDto>`               |
| GET       | `/api/challenges/{challengeId}/sales/commercials`              | (optional) `id`, `name`           | `List<SalesTransactionDto>`               |
| **Score Rules**                                                                                                                                                               |
| GET       | `/api/challenges/{challengeId}/score-rules`                    | —                                 | `List<ScoreRuleDto>`                      |
| GET       | `/api/challenges/{challengeId}/score-rules/{ruleId}`           | —                                 | `ScoreRuleDto`                            |
| POST      | `/api/challenges/{challengeId}/score-rules`                    | `ScoreRuleDto`                    | `ScoreRuleDto`                            |
| PUT       | `/api/challenges/{challengeId}/score-rules/{ruleId}`           | `ScoreRuleDto`                    | `ScoreRuleDto`                            |
| DELETE    | `/api/challenges/{challengeId}/score-rules/{ruleId}`           | —                                 | —                                         |
| **Users**                                                                                                                                                                     |
| GET       | `/api/users`                                                   | —                                 | `List<UserDto>`                           |
| POST      | `/api/users`                                                   | `@Valid UserDto`                  | `UserDto`                                 |
| GET       | `/api/users/{id}`                                              | —                                 | `UserDto`                                 |
| PUT       | `/api/users/{id}`                                              | `@Valid UserDto`                  | `UserDto`                                 |
| DELETE    | `/api/users/{id}`                                              | —                                 | —                                         |
